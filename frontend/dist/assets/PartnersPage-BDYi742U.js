import{j as e,q as y,l as w,K as C,r as S,p as U,N as P,O as z}from"./ui-DIb4OZiY.js";import{a}from"./vendor-Dc3V-jfM.js";import{S as k,B as l}from"./Sidebar-Dvmsl6BE.js";import"./index-DIhOCUIk.js";function F(){const[u,h]=a.useState([]),[p,b]=a.useState(!0),[c,f]=a.useState(""),[g,i]=a.useState(!1),[n,d]=a.useState(null),[t,r]=a.useState({name:"",subdomain:"",logoUrl:"",letterheadUrl:"",primaryColor:"#8B7355",isActive:!0});a.useEffect(()=>{m()},[]);const m=async()=>{try{const o=await(await fetch("/api/partners",{credentials:"include"})).json();o.success&&h(o.partners||[])}catch(s){console.error("Failed to fetch partners:",s)}finally{b(!1)}},j=async s=>{s.preventDefault();try{const o=n?`/api/partners/${n.id}`:"/api/partners";(await(await fetch(o,{method:n?"PUT":"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json()).success&&(i(!1),d(null),r({name:"",subdomain:"",logoUrl:"",letterheadUrl:"",primaryColor:"#8B7355",isActive:!0}),await m())}catch(o){console.error("Save error:",o)}},v=s=>{d(s),r({name:s.name,subdomain:s.subdomain,logoUrl:s.logoUrl||"",letterheadUrl:s.letterheadUrl||"",primaryColor:s.primaryColor||"#8B7355",isActive:s.isActive}),i(!0)},N=async s=>{if(confirm("Tem certeza que deseja excluir este parceiro? Todos os usuários associados serão desativados."))try{await fetch(`/api/partners/${s}`,{method:"DELETE",credentials:"include"}),await m()}catch(o){console.error("Delete error:",o)}},x=u.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.subdomain.toLowerCase().includes(c.toLowerCase()));return e.jsxs("div",{className:"h-screen flex bg-stone-50",children:[e.jsx(k,{}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsx("div",{className:"bg-white border-b border-stone-200 px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-stone-800 mb-2",children:"Parceiros (Multi-Tenancy)"}),e.jsx("p",{className:"text-stone-500",children:"Gerencie escritórios e organizações parceiras"})]}),e.jsxs(l,{onClick:()=>{d(null),r({name:"",subdomain:"",logoUrl:"",letterheadUrl:"",primaryColor:"#8B7355",isActive:!0}),i(!0)},className:"gap-2",children:[e.jsx(y,{className:"w-4 h-4"}),"Novo Parceiro"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(w,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-stone-400"}),e.jsx("input",{type:"text",placeholder:"Buscar parceiros...",value:c,onChange:s=>f(s.target.value),className:"w-full h-12 pl-12 pr-4 bg-white border border-stone-200 rounded-xl text-stone-700 placeholder:text-stone-400 focus:outline-none focus:ring-2 focus:ring-bronze-400/30 focus:border-bronze-400"})]})}),p?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-10 h-10 border-2 border-bronze-400 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-stone-500",children:"Carregando parceiros..."})]}):x.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-soft",children:[e.jsx(C,{className:"w-12 h-12 text-stone-300 mx-auto mb-3"}),e.jsx("p",{className:"text-stone-500",children:"Nenhum parceiro encontrado"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:x.map(s=>e.jsxs("div",{className:"bg-white rounded-xl shadow-soft p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-white font-semibold",style:{backgroundColor:s.primaryColor||"#8B7355"},children:s.name.substring(0,2).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-stone-800",children:s.name}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${s.isActive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:s.isActive?"Ativo":"Inativo"})})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>v(s),children:e.jsx(S,{className:"w-4 h-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>N(s.id),className:"text-red-500 hover:text-red-600 hover:bg-red-50",children:e.jsx(U,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-stone-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4 text-stone-400"}),e.jsxs("span",{className:"font-mono",children:[s.subdomain,".iarom.com.br"]})]}),s.userCount!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-stone-400"}),e.jsxs("span",{children:[s.userCount," usuário",s.userCount!==1?"s":""]})]})]})]},s.id))})]})})]}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md mx-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-stone-800 mb-4",children:n?"Editar Parceiro":"Novo Parceiro"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Nome"}),e.jsx("input",{type:"text",value:t.name,onChange:s=>r({...t,name:s.target.value}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Subdomínio"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:t.subdomain,onChange:s=>r({...t,subdomain:s.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")}),className:"flex-1 h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",required:!0,placeholder:"exemplo"}),e.jsx("span",{className:"text-sm text-stone-500",children:".iarom.com.br"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Logo URL (opcional)"}),e.jsx("input",{type:"url",value:t.logoUrl,onChange:s=>r({...t,logoUrl:s.target.value}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",placeholder:"https://exemplo.com/logo.png"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Timbre/Letterhead URL (opcional)"}),e.jsx("input",{type:"url",value:t.letterheadUrl,onChange:s=>r({...t,letterheadUrl:s.target.value}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",placeholder:"https://exemplo.com/timbre.png"}),e.jsx("p",{className:"text-xs text-stone-500 mt-1",children:"Imagem do timbre do escritório para documentos oficiais"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Cor Primária"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"color",value:t.primaryColor,onChange:s=>r({...t,primaryColor:s.target.value}),className:"w-14 h-11 rounded-xl border border-stone-200 cursor-pointer"}),e.jsx("input",{type:"text",value:t.primaryColor,onChange:s=>r({...t,primaryColor:s.target.value}),className:"flex-1 h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 font-mono focus:outline-none focus:ring-2 focus:ring-bronze-400/30"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:t.isActive,onChange:s=>r({...t,isActive:s.target.checked}),className:"w-4 h-4 rounded border-stone-300 text-bronze-600 focus:ring-bronze-400"}),e.jsx("label",{htmlFor:"isActive",className:"text-sm font-medium text-stone-700",children:"Parceiro ativo"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(l,{type:"button",variant:"secondary",onClick:()=>i(!1),className:"flex-1",children:"Cancelar"}),e.jsx(l,{type:"submit",className:"flex-1",children:n?"Salvar":"Criar"})]})]})]})})]})}export{F as PartnersPage};
