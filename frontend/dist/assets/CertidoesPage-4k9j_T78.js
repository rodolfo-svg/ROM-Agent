import{j as e,z as d,l as N,u as v,B as g,y as w,a as C,D as y}from"./ui-DIb4OZiY.js";import{a}from"./vendor-Dc3V-jfM.js";import{S,B as l}from"./Sidebar-tIKYRUac.js";import"./index-23MLp_hx.js";function q(){const[m,h]=a.useState([]),[u,p]=a.useState(!0),[o,f]=a.useState(""),[j,i]=a.useState(!1),[t,r]=a.useState({type:"criminal",personName:"",cpfCnpj:""});a.useEffect(()=>{x()},[]);const x=async()=>{try{const n=await(await fetch("/api/certidoes",{credentials:"include"})).json();n.success&&h(n.certidoes||[])}catch(s){console.error("Failed to fetch certidoes:",s)}finally{p(!1)}},b=async s=>{s.preventDefault();try{(await(await fetch("/api/certidoes/request",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json()).success&&(i(!1),r({type:"criminal",personName:"",cpfCnpj:""}),await x())}catch(n){console.error("Request error:",n)}},c=m.filter(s=>s.personName.toLowerCase().includes(o.toLowerCase())||s.cpfCnpj.includes(o));return e.jsxs("div",{className:"h-screen flex bg-stone-50",children:[e.jsx(S,{}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsx("div",{className:"bg-white border-b border-stone-200 px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-stone-800 mb-2",children:"Certidões Judiciais"}),e.jsx("p",{className:"text-stone-500",children:"Solicite e gerencie certidões judiciais"})]}),e.jsxs(l,{onClick:()=>i(!0),className:"gap-2",children:[e.jsx(d,{className:"w-4 h-4"}),"Nova Solicitação"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-stone-400"}),e.jsx("input",{type:"text",placeholder:"Buscar por nome ou CPF/CNPJ...",value:o,onChange:s=>f(s.target.value),className:"w-full h-12 pl-12 pr-4 bg-white border border-stone-200 rounded-xl text-stone-700 placeholder:text-stone-400 focus:outline-none focus:ring-2 focus:ring-bronze-400/30 focus:border-bronze-400"})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-soft overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-stone-100",children:e.jsxs("h2",{className:"font-semibold text-stone-800",children:["Solicitações (",c.length,")"]})}),u?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-10 h-10 border-2 border-bronze-400 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-stone-500",children:"Carregando certidões..."})]}):c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(d,{className:"w-12 h-12 text-stone-300 mx-auto mb-3"}),e.jsx("p",{className:"text-stone-500",children:"Nenhuma certidão encontrada"})]}):e.jsx("div",{className:"divide-y divide-stone-100",children:c.map(s=>e.jsx("div",{className:"px-6 py-5 hover:bg-stone-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx(d,{className:"w-5 h-5 text-bronze-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-stone-800",children:s.personName}),s.status==="completed"&&e.jsx(v,{className:"w-4 h-4 text-green-500"}),s.status==="pending"&&e.jsx(g,{className:"w-4 h-4 text-bronze-500"})]}),e.jsxs("p",{className:"text-sm text-stone-600 mb-2",children:[s.type," • ",s.cpfCnpj]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-stone-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"w-4 h-4"}),new Date(s.createdAt).toLocaleDateString("pt-BR")]}),s.completedAt&&e.jsxs("span",{children:["Concluída em ",new Date(s.completedAt).toLocaleDateString("pt-BR")]})]})]})]}),s.status==="completed"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(C,{className:"w-4 h-4"})}),e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(y,{className:"w-4 h-4"})})]})]})},s.id))})]})]})})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md mx-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-stone-800 mb-4",children:"Nova Solicitação"}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Tipo de Certidão"}),e.jsxs("select",{value:t.type,onChange:s=>r({...t,type:s.target.value}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",required:!0,children:[e.jsx("option",{value:"criminal",children:"Criminal"}),e.jsx("option",{value:"civil",children:"Cível"}),e.jsx("option",{value:"trabalhista",children:"Trabalhista"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Nome Completo"}),e.jsx("input",{type:"text",value:t.personName,onChange:s=>r({...t,personName:s.target.value}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"CPF/CNPJ"}),e.jsx("input",{type:"text",value:t.cpfCnpj,onChange:s=>r({...t,cpfCnpj:s.target.value}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",required:!0})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(l,{type:"button",variant:"secondary",onClick:()=>i(!1),className:"flex-1",children:"Cancelar"}),e.jsx(l,{type:"submit",className:"flex-1",children:"Solicitar"})]})]})]})})]})}export{q as CertidoesPage};
