import{j as e,q as y,l as S,H as C,I as z,J as U,r as k,p as E}from"./ui-DIb4OZiY.js";import{a as o}from"./vendor-Dc3V-jfM.js";import{S as q,B as l,A as D}from"./Sidebar-CW8v-IBL.js";import"./index-D2MRyA27.js";function O(){const[u,h]=o.useState([]),[b,f]=o.useState(!0),[c,p]=o.useState(""),[j,i]=o.useState(!1),[n,d]=o.useState(null),[t,a]=o.useState({name:"",email:"",role:"user",oab:"",password:""});o.useEffect(()=>{x()},[]);const x=async()=>{try{const r=await(await fetch("/api/users",{credentials:"include"})).json();r.success&&h(r.users||[])}catch(s){console.error("Failed to fetch users:",s)}finally{f(!1)}},g=async s=>{s.preventDefault();try{const r=n?`/api/users/${n.id}`:"/api/users";(await(await fetch(r,{method:n?"PUT":"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json()).success&&(i(!1),d(null),a({name:"",email:"",role:"user",oab:"",password:""}),await x())}catch(r){console.error("Save error:",r)}},v=s=>{d(s),a({name:s.name,email:s.email,role:s.role,oab:s.oab||"",password:""}),i(!0)},N=async s=>{if(confirm("Tem certeza que deseja excluir este usuário?"))try{await fetch(`/api/users/${s}`,{method:"DELETE",credentials:"include"}),await x()}catch(r){console.error("Delete error:",r)}},m=u.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase())),w=s=>{switch(s){case"admin":return"bg-red-100 text-red-700";case"user":return"bg-blue-100 text-blue-700";case"viewer":return"bg-gray-100 text-gray-700";default:return"bg-stone-100 text-stone-700"}};return e.jsxs("div",{className:"h-screen flex bg-stone-50",children:[e.jsx(q,{}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsx("div",{className:"bg-white border-b border-stone-200 px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-stone-800 mb-2",children:"Gerenciamento de Usuários"}),e.jsx("p",{className:"text-stone-500",children:"Gerencie usuários e permissões do sistema"})]}),e.jsxs(l,{onClick:()=>{d(null),a({name:"",email:"",role:"user",oab:"",password:""}),i(!0)},className:"gap-2",children:[e.jsx(y,{className:"w-4 h-4"}),"Novo Usuário"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-stone-400"}),e.jsx("input",{type:"text",placeholder:"Buscar usuários...",value:c,onChange:s=>p(s.target.value),className:"w-full h-12 pl-12 pr-4 bg-white border border-stone-200 rounded-xl text-stone-700 placeholder:text-stone-400 focus:outline-none focus:ring-2 focus:ring-bronze-400/30 focus:border-bronze-400"})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-soft overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-stone-100",children:e.jsxs("h2",{className:"font-semibold text-stone-800",children:["Usuários (",m.length,")"]})}),b?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-10 h-10 border-2 border-bronze-400 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-stone-500",children:"Carregando usuários..."})]}):m.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(C,{className:"w-12 h-12 text-stone-300 mx-auto mb-3"}),e.jsx("p",{className:"text-stone-500",children:"Nenhum usuário encontrado"})]}):e.jsx("div",{className:"divide-y divide-stone-100",children:m.map(s=>e.jsxs("div",{className:"px-6 py-5 flex items-center gap-4 hover:bg-stone-50 transition-colors",children:[e.jsx(D,{name:s.name,size:"md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-stone-800",children:s.name}),e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${w(s.role)}`,children:s.role})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-stone-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-4 h-4"}),s.email]}),s.oab&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"w-4 h-4"}),s.oab]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>v(s),children:e.jsx(k,{className:"w-4 h-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>N(s.id),className:"text-red-500 hover:text-red-600 hover:bg-red-50",children:e.jsx(E,{className:"w-4 h-4"})})]})]},s.id))})]})]})})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md mx-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-stone-800 mb-4",children:n?"Editar Usuário":"Novo Usuário"}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Nome"}),e.jsx("input",{type:"text",value:t.name,onChange:s=>a({...t,name:s.target.value}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:t.email,onChange:s=>a({...t,email:s.target.value}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Função"}),e.jsxs("select",{value:t.role,onChange:s=>a({...t,role:s.target.value}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",required:!0,children:[e.jsx("option",{value:"viewer",children:"Visualizador"}),e.jsx("option",{value:"user",children:"Usuário"}),e.jsx("option",{value:"admin",children:"Administrador"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"OAB (opcional)"}),e.jsx("input",{type:"text",value:t.oab,onChange:s=>a({...t,oab:s.target.value}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:["Senha ",n&&"(deixe em branco para não alterar)"]}),e.jsx("input",{type:"password",value:t.password,onChange:s=>a({...t,password:s.target.value}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",required:!n})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(l,{type:"button",variant:"secondary",onClick:()=>i(!1),className:"flex-1",children:"Cancelar"}),e.jsx(l,{type:"submit",className:"flex-1",children:n?"Salvar":"Criar"})]})]})]})})]})}export{O as UsersPage};
