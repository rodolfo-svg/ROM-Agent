import{j as e,q as $,l as B,F as j,e as F,d as J,r as A,p as O,s as I}from"./ui-DIb4OZiY.js";import{a as o}from"./vendor-Dc3V-jfM.js";import{S as M,B as n}from"./Sidebar-BnL4kc_2.js";import{u as Q}from"./index-KsEwBOLC.js";function K(){const{user:d}=Q(),h=(d==null?void 0:d.role)==="admin",[p,v]=o.useState([]),[N,w]=o.useState(!0),[x,y]=o.useState(""),[m,C]=o.useState("all"),[S,g]=o.useState(null),[z,i]=o.useState(!1),[u,f]=o.useState(null),[a,r]=o.useState({id:"",title:"",description:"",category:"gerais",template:"",tags:[]});o.useEffect(()=>{c()},[]);const c=async()=>{try{const t=await(await fetch("/api/rom-prompts",{credentials:"include"})).json();if(t.success){const l=[...t.prompts.gerais||[],...t.prompts.judiciais||[],...t.prompts.extrajudiciais||[]];v(l)}}catch(s){console.error("Failed to fetch prompts:",s)}finally{w(!1)}},P=async(s,t)=>{await navigator.clipboard.writeText(s),g(t),setTimeout(()=>g(null),2e3)},k=s=>{f(s),r({id:s.id,title:s.title,description:s.description,category:s.category,template:s.template,tags:s.tags||[]}),i(!0)},T=()=>{f(null),r({id:"",title:"",description:"",category:"gerais",template:"",tags:[]}),i(!0)},E=async s=>{s.preventDefault();try{const t={prompt:{id:a.id||a.title.toLowerCase().replace(/\s+/g,"-"),title:a.title,description:a.description,template:a.template,tags:a.tags,category:a.category}};u?(await fetch(`/api/rom-prompts/${a.category}/${t.prompt.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).ok&&(i(!1),await c()):(await fetch(`/api/rom-prompts/${a.category}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).ok&&(i(!1),r({id:"",title:"",description:"",category:"gerais",template:"",tags:[]}),await c())}catch(t){console.error("Save error:",t)}},D=async s=>{if(confirm(`Tem certeza que deseja excluir "${s.title}"?`))try{await fetch(`/api/rom-prompts/${s.category}/${s.id}`,{method:"DELETE",credentials:"include"}),await c()}catch(t){console.error("Delete error:",t)}},q=["all",...new Set(p.map(s=>s.category))],b=p.filter(s=>{const t=s.title.toLowerCase().includes(x.toLowerCase())||s.description.toLowerCase().includes(x.toLowerCase()),l=m==="all"||s.category===m;return t&&l});return e.jsxs("div",{className:"h-screen flex bg-stone-50",children:[e.jsx(M,{}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsx("div",{className:"bg-white border-b border-stone-200 px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-stone-800 mb-2",children:"Prompts Jurídicos"}),e.jsx("p",{className:"text-stone-500",children:"Biblioteca de templates especializados para documentos jurídicos"})]}),h&&e.jsxs(n,{onClick:T,className:"gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"Novo Prompt"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-soft p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(B,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-stone-400"}),e.jsx("input",{type:"text",placeholder:"Buscar prompts...",value:x,onChange:s=>y(s.target.value),className:"w-full h-12 pl-12 pr-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 placeholder:text-stone-400 focus:outline-none focus:ring-2 focus:ring-bronze-400/30 focus:border-bronze-400"})]}),e.jsx("select",{value:m,onChange:s=>C(s.target.value),className:"h-12 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30 focus:border-bronze-400",children:q.map(s=>e.jsx("option",{value:s,children:s==="all"?"Todas as categorias":s},s))})]})}),N?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-10 h-10 border-2 border-bronze-400 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-stone-500",children:"Carregando prompts..."})]}):b.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-soft",children:[e.jsx(j,{className:"w-12 h-12 text-stone-300 mx-auto mb-3"}),e.jsx("p",{className:"text-stone-500",children:"Nenhum prompt encontrado"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(s=>{var t;return e.jsxs("div",{className:"bg-white rounded-xl shadow-soft p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx(j,{className:"w-5 h-5 text-bronze-500 flex-shrink-0"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>P(s.template,s.id),className:"text-stone-500 hover:text-bronze-600",children:S===s.id?e.jsx(F,{className:"w-4 h-4 text-green-500"}):e.jsx(J,{className:"w-4 h-4"})}),h&&e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>k(s),className:"text-stone-500 hover:text-bronze-600",children:e.jsx(A,{className:"w-4 h-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>D(s),className:"text-red-500 hover:text-red-600 hover:bg-red-50",children:e.jsx(O,{className:"w-4 h-4"})})]})]})]}),e.jsx("h3",{className:"font-semibold text-stone-800 mb-2",children:s.title}),e.jsx("p",{className:"text-sm text-stone-500 mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-bronze-100 text-bronze-700 text-xs rounded-lg",children:[e.jsx(I,{className:"w-3 h-3"}),s.category]}),(t=s.tags)==null?void 0:t.slice(0,2).map((l,L)=>e.jsx("span",{className:"px-2 py-1 bg-stone-100 text-stone-600 text-xs rounded-lg",children:l},L))]})]},s.id)})})]})})]}),z&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-semibold text-stone-800 mb-4",children:u?"Editar Prompt":"Novo Prompt"}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Título"}),e.jsx("input",{type:"text",value:a.title,onChange:s=>r({...a,title:s.target.value}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Categoria"}),e.jsxs("select",{value:a.category,onChange:s=>r({...a,category:s.target.value}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",required:!0,children:[e.jsx("option",{value:"gerais",children:"Gerais"}),e.jsx("option",{value:"judiciais",children:"Judiciais"}),e.jsx("option",{value:"extrajudiciais",children:"Extrajudiciais"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Descrição"}),e.jsx("textarea",{value:a.description,onChange:s=>r({...a,description:s.target.value}),rows:2,className:"w-full px-4 py-3 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30 resize-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Template/Conteúdo"}),e.jsx("textarea",{value:a.template,onChange:s=>r({...a,template:s.target.value}),rows:12,className:"w-full px-4 py-3 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 font-mono text-sm focus:outline-none focus:ring-2 focus:ring-bronze-400/30 resize-none",required:!0,placeholder:"Digite o template do prompt aqui..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Tags (separadas por vírgula)"}),e.jsx("input",{type:"text",value:a.tags.join(", "),onChange:s=>r({...a,tags:s.target.value.split(",").map(t=>t.trim()).filter(Boolean)}),className:"w-full h-11 px-4 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 focus:outline-none focus:ring-2 focus:ring-bronze-400/30",placeholder:"exemplo: petição, trabalhista, inicial"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(n,{type:"button",variant:"secondary",onClick:()=>i(!1),className:"flex-1",children:"Cancelar"}),e.jsx(n,{type:"submit",className:"flex-1",children:u?"Salvar Alterações":"Criar Prompt"})]})]})]})})]})}export{K as PromptsPage};
