# ğŸ’° SISTEMA DE TARIFAÃ‡ÃƒO ROM AGENT - COMPLETO

**VersÃ£o**: 2.6.0
**Data**: 13 de dezembro de 2024
**Modelo de NegÃ³cio**: Custos Reais + Markup de 30%
**Escopo**: TODOS os modelos de IA + Infraestrutura + Storage + APIs

---

## ğŸ“Š ESTRUTURA COMPLETA DE CUSTOS

### 1. MODELOS DE IA DISPONÃVEIS (AWS Bedrock)

#### Claude Sonnet 4.5 (Modelo Principal - PeÃ§as Complexas)
```
Input:  $0.003 / 1K tokens
Output: $0.015 / 1K tokens

Uso recomendado:
âœ“ PetiÃ§Ãµes iniciais complexas
âœ“ Recursos de apelaÃ§Ã£o
âœ“ Habeas corpus
âœ“ Pareceres jurÃ­dicos
âœ“ AnÃ¡lise profunda de documentos

Exemplo de uso:
- PetiÃ§Ã£o Inicial (5000 tokens input, 8000 tokens output):
  Custo = (5 Ã— $0.003) + (8 Ã— $0.015) = $0.015 + $0.120 = $0.135
```

#### Claude Haiku (Modelo EconÃ´mico - Tarefas Simples)
```
Input:  $0.00025 / 1K tokens
Output: $0.00125 / 1K tokens

Uso recomendado:
âœ“ ExtraÃ§Ãµes simples de documentos
âœ“ Resumos rÃ¡pidos
âœ“ AnÃ¡lise de jurisprudÃªncia
âœ“ Busca em KB
âœ“ Respostas curtas

Exemplo de uso:
- ExtraÃ§Ã£o de dados (3000 tokens input, 1000 tokens output):
  Custo = (3 Ã— $0.00025) + (1 Ã— $0.00125) = $0.00075 + $0.00125 = $0.002

ECONOMIA: 67x mais barato que Sonnet 4.5!
```

#### Claude Opus (Modelo Premium - Casos CrÃ­ticos)
```
Input:  $0.015 / 1K tokens
Output: $0.075 / 1K tokens

Uso recomendado:
âœ“ Casos de alta complexidade (STF/STJ)
âœ“ Pareceres tÃ©cnicos especializados
âœ“ AnÃ¡lise de leading cases
âœ“ Recursos extraordinÃ¡rios
âœ“ Teses inovadoras

Exemplo de uso:
- Recurso ExtraordinÃ¡rio (7000 tokens input, 12000 tokens output):
  Custo = (7 Ã— $0.015) + (12 Ã— $0.075) = $0.105 + $0.900 = $1.005

QUALIDADE: 5x mais preciso em casos crÃ­ticos
```

### 2. COMPARATIVO DE MODELOS

| Modelo | Input ($/1K) | Output ($/1K) | Velocidade | Qualidade | Uso Ideal |
|--------|--------------|---------------|------------|-----------|-----------|
| **Haiku** | $0.00025 | $0.00125 | âš¡âš¡âš¡ RÃ¡pido | â­â­â­ Boa | ExtraÃ§Ãµes simples |
| **Sonnet 4.5** | $0.003 | $0.015 | âš¡âš¡ Normal | â­â­â­â­ Ã“tima | PeÃ§as padrÃ£o |
| **Opus** | $0.015 | $0.075 | âš¡ Lento | â­â­â­â­â­ Excelente | Casos crÃ­ticos |

### 3. CUSTO POR TIPO DE PEÃ‡A (Estimativa)

#### Usando Claude Sonnet 4.5:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tipo de PeÃ§a          â”‚ Tokens â”‚ Custo AWS â”‚ +30% â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PetiÃ§Ã£o Inicial       â”‚ 13K    â”‚ $0.135    â”‚ $0.18â”‚
â”‚ ContestaÃ§Ã£o           â”‚ 10K    â”‚ $0.105    â”‚ $0.14â”‚
â”‚ Recurso de ApelaÃ§Ã£o   â”‚ 15K    â”‚ $0.165    â”‚ $0.21â”‚
â”‚ Agravo de Instrumento â”‚ 8K     â”‚ $0.075    â”‚ $0.10â”‚
â”‚ Habeas Corpus         â”‚ 7K     â”‚ $0.066    â”‚ $0.09â”‚
â”‚ Parecer JurÃ­dico      â”‚ 20K    â”‚ $0.240    â”‚ $0.31â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MÃ©dia: $0.15/peÃ§a (Sonnet 4.5)
```

#### Usando Claude Haiku (Economia):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tipo de PeÃ§a          â”‚ Tokens â”‚ Custo AWS â”‚ +30% â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PetiÃ§Ã£o Simples       â”‚ 10K    â”‚ $0.015    â”‚ $0.02â”‚
â”‚ ExtraÃ§Ã£o de Dados     â”‚ 4K     â”‚ $0.002    â”‚ $0.003â”‚
â”‚ Resumo de Documento   â”‚ 5K     â”‚ $0.005    â”‚ $0.007â”‚
â”‚ AnÃ¡lise KB            â”‚ 3K     â”‚ $0.002    â”‚ $0.003â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MÃ©dia: $0.01/peÃ§a (Haiku)
ECONOMIA: 93% vs Sonnet 4.5
```

### 4. Armazenamento (Render.com)
```
FREE:     1 GB   - $0/mÃªs
STARTER:  10 GB  - $7/mÃªs
STANDARD: 50 GB  - $25/mÃªs
PRO:      100 GB - $85/mÃªs
```

### 5. Infraestrutura (Render.com)
```
Web Service: $7/mÃªs (plano base)
CDN/Bandwidth: incluÃ­do
SSL: incluÃ­do
```

### 6. APIs Externas
```
DataJud CNJ: $20/mÃªs (acesso ilimitado)
STF/STJ APIs: gratuitas (limitadas)
Jusbrasil: credenciais do parceiro (sem custo adicional)
```

### 7. CUSTO TOTAL POR CATEGORIA

#### Exemplo: EscritÃ³rio MÃ©dio (500 peÃ§as/mÃªs)

**CenÃ¡rio 1: Usando APENAS Sonnet 4.5**
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
AWS Bedrock:
  500 peÃ§as Ã— $0.15 = $75,00

Storage (50 GB): $25,00
Infraestrutura: $7,00
DataJud API: $20,00
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
SUBTOTAL: $127,00
Markup 30%: $38,10
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
TOTAL: $165,10 ou R$ 826/mÃªs
```

**CenÃ¡rio 2: Modelo INTELIGENTE (Mix de Modelos)**
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
AWS Bedrock:
  300 peÃ§as Sonnet 4.5 Ã— $0.15 = $45,00
  150 peÃ§as Haiku Ã— $0.01 = $1,50
  50 peÃ§as Opus Ã— $1.00 = $50,00

  Total IA: $96,50

Storage (50 GB): $25,00
Infraestrutura: $7,00
DataJud API: $20,00
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
SUBTOTAL: $148,50
Markup 30%: $44,55
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
TOTAL: $193,05 ou R$ 965/mÃªs

ECONOMIA vs CenÃ¡rio 1: -$27,95/mÃªs
QUALIDADE: Melhor (casos crÃ­ticos com Opus)
```

**CenÃ¡rio 3: ECONOMIA MÃXIMA (Haiku + Sonnet)**
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
AWS Bedrock:
  250 peÃ§as Haiku Ã— $0.01 = $2,50
  250 peÃ§as Sonnet 4.5 Ã— $0.15 = $37,50

  Total IA: $40,00

Storage (50 GB): $25,00
Infraestrutura: $7,00
DataJud API: $20,00
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
SUBTOTAL: $92,00
Markup 30%: $27,60
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
TOTAL: $119,60 ou R$ 598/mÃªs

ECONOMIA vs CenÃ¡rio 1: -$45,50/mÃªs (28%)
ECONOMIA vs CenÃ¡rio 2: -$73,45/mÃªs (38%)
```

---

## ğŸ’µ PLANOS ROM AGENT (COM MARKUP 30% - TODOS OS MODELOS)

### Plano ESSENCIAL
```
âœ… Ideal para: Advogado Individual ou EscritÃ³rio Pequeno

Recursos:
â€¢ 100 peÃ§as/mÃªs
â€¢ Armazenamento: 10 GB (300-600 processos)
â€¢ AnÃ¡lise inteligente de documentos
â€¢ Upload atÃ© 100 MB por arquivo
â€¢ Suporte por email

MODELO: Haiku + Sonnet 4.5 (Roteamento Inteligente)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

CÃ¡lculo de Custos (Mix Inteligente):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. AWS Bedrock:
   â€¢ 60 peÃ§as Haiku Ã— $0.01:               $0,60
   â€¢ 40 peÃ§as Sonnet 4.5 Ã— $0.15:          $6,00
   Total IA:                                $6,60

2. Armazenamento (10 GB):                   $7,00
3. Infraestrutura base:                     $7,00
4. APIs (proporÃ§Ã£o):                        $5,00
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   SUBTOTAL (Custos reais USD):            $25,60
   + Markup 30%:                            $7,68
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SUBTOTAL com Markup:                    $33,28
   + IOF 6,38% (operaÃ§Ã£o estrangeira):     $2,12
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   TOTAL ao Parceiro (USD):                $35,40
   ou R$ 177,00/mÃªs (taxa de cÃ¢mbio: R$ 5,00)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ECONOMIA vs Plano SÃ³ Sonnet: R$ 31,00/mÃªs (15%)
```

### Plano PROFISSIONAL
```
âœ… Ideal para: EscritÃ³rio MÃ©dio (3-5 advogados)

Recursos:
â€¢ 500 peÃ§as/mÃªs
â€¢ Armazenamento: 50 GB (1500-3000 processos)
â€¢ AnÃ¡lise inteligente + SugestÃ£o de estratÃ©gias
â€¢ Upload atÃ© 100 MB por arquivo
â€¢ 33 ferramentas de extraÃ§Ã£o
â€¢ Suporte prioritÃ¡rio

MODELO: Haiku + Sonnet 4.5 (Roteamento Inteligente AvanÃ§ado)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

CÃ¡lculo de Custos (Mix Inteligente):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. AWS Bedrock:
   â€¢ 250 peÃ§as Haiku Ã— $0.01:              $2,50
   â€¢ 250 peÃ§as Sonnet 4.5 Ã— $0.15:        $37,50
   Total IA:                               $40,00

2. Armazenamento (50 GB):                  $25,00
3. Infraestrutura base:                     $7,00
4. DataJud API:                            $20,00
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   SUBTOTAL (Custos reais USD):            $92,00
   + Markup 30%:                           $27,60
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SUBTOTAL com Markup:                   $119,60
   + IOF 6,38% (operaÃ§Ã£o estrangeira):     $7,63
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   TOTAL ao Parceiro (USD):               $127,23
   ou R$ 636,15/mÃªs (taxa de cÃ¢mbio: R$ 5,00)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ECONOMIA vs Plano SÃ³ Sonnet: R$ 105,00/mÃªs (14%)
```

### Plano EMPRESARIAL
```
âœ… Ideal para: Grande EscritÃ³rio (10+ advogados)

Recursos:
â€¢ 2000 peÃ§as/mÃªs
â€¢ Armazenamento: 100 GB (3000-6000 processos)
â€¢ AnÃ¡lise inteligente + JurisprudÃªncia automatizada
â€¢ Upload atÃ© 100 MB por arquivo
â€¢ 33 ferramentas + APIs personalizadas
â€¢ Multi-tenant (vÃ¡rios escritÃ³rios)
â€¢ Suporte 24/7

MODELO: Haiku + Sonnet 4.5 + Opus (Roteamento Completo)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

CÃ¡lculo de Custos (Mix Completo de 3 Modelos):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. AWS Bedrock:
   â€¢ 1000 peÃ§as Haiku Ã— $0.01:            $10,00
   â€¢ 800 peÃ§as Sonnet 4.5 Ã— $0.15:       $120,00
   â€¢ 200 peÃ§as Opus Ã— $1.00:             $200,00
   Total IA:                              $330,00

2. Armazenamento (100 GB):                 $85,00
3. Infraestrutura base:                     $7,00
4. DataJud API:                            $20,00
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   SUBTOTAL (Custos reais USD):           $442,00
   + Markup 30%:                          $132,60
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SUBTOTAL com Markup:                   $574,60
   + IOF 6,38% (operaÃ§Ã£o estrangeira):    $36,66
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   TOTAL ao Parceiro (USD):               $611,26
   ou R$ 3.056,30/mÃªs (taxa de cÃ¢mbio: R$ 5,00)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

QUALIDADE: MÃ¡xima (inclui Opus para casos STF/STJ)
ECONOMIA vs Plano SÃ³ Sonnet: -R$ 730,00/mÃªs*
*Considerando plano sÃ³ Sonnet custaria R$ 3.786/mÃªs
```

### Plano PAY-AS-YOU-GO (Sob Demanda)
```
âœ… Ideal para: Uso eventual ou testes

Recursos:
â€¢ Sem mensalidade
â€¢ Paga apenas o que usar
â€¢ Armazenamento: FREE (1 GB)
â€¢ Upload atÃ© 100 MB por arquivo

CÃ¡lculo de Custos por PeÃ§a (Sonnet 4.5):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   Custo AWS: $0.15
   + Markup 30%: $0.045
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SUBTOTAL: $0.195
   + IOF 6,38%: $0.012
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   TOTAL: $0.207/peÃ§a (ou R$ 1,04/peÃ§a)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

VariaÃ§Ãµes por Modelo:
â€¢ Haiku:       $0.013/peÃ§a (R$ 0,07) - ExtraÃ§Ãµes
â€¢ Sonnet 4.5:  $0.207/peÃ§a (R$ 1,04) - PeÃ§as padrÃ£o
â€¢ Opus:        $1.377/peÃ§a (R$ 6,89) - Casos crÃ­ticos
```

---

## ğŸ¤– SISTEMA DE ROTEAMENTO INTELIGENTE DE MODELOS

### Como Funciona?

O ROM Agent v2.6.0 inclui um sistema **AUTOMÃTICO** que escolhe o melhor modelo para cada tarefa, otimizando custo e qualidade.

#### 1. AnÃ¡lise AutomÃ¡tica da Tarefa
```javascript
// Sistema analisa cada requisiÃ§Ã£o e classifica por complexidade

Tarefa: "Extrair nome e CPF do documento"
â†’ Complexidade: BAIXA
â†’ Modelo Selecionado: Haiku
â†’ Motivo: ExtraÃ§Ã£o simples, nÃ£o requer raciocÃ­nio complexo
â†’ Custo: $0.002 (vs $0.135 no Sonnet)
â†’ ECONOMIA: 98%

Tarefa: "Redigir petiÃ§Ã£o inicial de dano moral"
â†’ Complexidade: MÃ‰DIA
â†’ Modelo Selecionado: Sonnet 4.5
â†’ Motivo: Requer argumentaÃ§Ã£o jurÃ­dica sÃ³lida
â†’ Custo: $0.135
â†’ Qualidade: Ã“tima

Tarefa: "Recurso ExtraordinÃ¡rio ao STF"
â†’ Complexidade: ALTA
â†’ Modelo Selecionado: Opus
â†’ Motivo: Caso crÃ­tico com repercussÃ£o geral
â†’ Custo: $1.005
â†’ Qualidade: Excelente (necessÃ¡rio para STF)
```

#### 2. Matriz de DecisÃ£o AutomÃ¡tica

| Tipo de Tarefa | Complexidade | Modelo Auto-Selecionado | Economia |
|----------------|--------------|-------------------------|----------|
| ExtraÃ§Ã£o de dados | â­ Baixa | Haiku | 98% |
| Resumo de documento | â­ Baixa | Haiku | 98% |
| Busca em KB | â­ Baixa | Haiku | 98% |
| AnÃ¡lise de jurisprudÃªncia | â­â­ MÃ©dia-Baixa | Haiku | 98% |
| PetiÃ§Ã£o simples | â­â­ MÃ©dia | Sonnet 4.5 | - |
| ContestaÃ§Ã£o | â­â­â­ MÃ©dia | Sonnet 4.5 | - |
| Recurso de ApelaÃ§Ã£o | â­â­â­ MÃ©dia-Alta | Sonnet 4.5 | - |
| Parecer tÃ©cnico | â­â­â­â­ Alta | Opus | 0% |
| Recurso STF/STJ | â­â­â­â­â­ CrÃ­tica | Opus | 0% |
| Leading case analysis | â­â­â­â­ Alta | Opus | 0% |

#### 3. Exemplo PrÃ¡tico: Fluxo Completo

**Caso: AÃ§Ã£o de indenizaÃ§Ã£o por acidente de trÃ¢nsito**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PASSO 1: Upload de 5 documentos                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tarefa: Extrair dados dos documentos               â”‚
â”‚ Modelo: Haiku                                       â”‚
â”‚ Tokens: 15K                                         â”‚
â”‚ Custo: $0.015                                       â”‚
â”‚ Tempo: 3 segundos                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PASSO 2: Buscar jurisprudÃªncia relevante           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tarefa: Analisar 20 acÃ³rdÃ£os                       â”‚
â”‚ Modelo: Haiku                                       â”‚
â”‚ Tokens: 8K                                          â”‚
â”‚ Custo: $0.008                                       â”‚
â”‚ Tempo: 2 segundos                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PASSO 3: Redigir petiÃ§Ã£o inicial                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tarefa: PetiÃ§Ã£o inicial complexa                   â”‚
â”‚ Modelo: Sonnet 4.5                                  â”‚
â”‚ Tokens: 13K                                         â”‚
â”‚ Custo: $0.135                                       â”‚
â”‚ Tempo: 8 segundos                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CUSTO TOTAL DO FLUXO: $0.158
(vs $0.405 se usasse sÃ³ Sonnet em tudo)
ECONOMIA: 61%
```

#### 4. Override Manual (Opcional)

O advogado pode **FORÃ‡AR** um modelo especÃ­fico se quiser:

```
âœ“ "Use Opus para esta petiÃ§Ã£o" â†’ Sistema usa Opus
âœ“ "Use Haiku para economizar" â†’ Sistema usa Haiku
âœ“ "Auto" (padrÃ£o) â†’ Sistema escolhe automaticamente
```

#### 5. RelatÃ³rio de Uso por Modelo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RELATÃ“RIO MENSAL - EscritÃ³rio Silva & Associadosâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Haiku:                                           â”‚
â”‚   â€¢ 250 tarefas                                  â”‚
â”‚   â€¢ Custo: $2.50                                 â”‚
â”‚   â€¢ Uso: ExtraÃ§Ãµes, buscas, resumos             â”‚
â”‚                                                  â”‚
â”‚ Sonnet 4.5:                                      â”‚
â”‚   â€¢ 200 peÃ§as                                    â”‚
â”‚   â€¢ Custo: $30.00                                â”‚
â”‚   â€¢ Uso: PetiÃ§Ãµes, recursos, contestaÃ§Ãµes       â”‚
â”‚                                                  â”‚
â”‚ Opus:                                            â”‚
â”‚   â€¢ 50 peÃ§as crÃ­ticas                            â”‚
â”‚   â€¢ Custo: $50.00                                â”‚
â”‚   â€¢ Uso: STF, STJ, pareceres tÃ©cnicos           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL IA: $82.50                                 â”‚
â”‚ ECONOMIA vs SÃ³ Sonnet: $57.50 (41%)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ COMPARATIVO DE CUSTOS (ATUALIZADO)

| Plano | PeÃ§as/mÃªs | Custo Real | Markup 30% | Total | R$/mÃªs |
|-------|-----------|------------|------------|-------|--------|
| **ESSENCIAL** | 100 | $29,00 | $8,70 | **$37,70** | **R$ 189** |
| **PROFISSIONAL** | 500 | $107,00 | $32,10 | **$139,10** | **R$ 696** |
| **EMPRESARIAL** | 2000 | $412,00 | $123,60 | **$535,60** | **R$ 2.678** |
| **PAY-AS-YOU-GO** | variÃ¡vel | $0,15/peÃ§a | $0,045 | **$0,195/peÃ§a** | **R$ 0,98** |

---

## ğŸ¯ TRACKING DE USO POR PARCEIRO

### MÃ©tricas Monitoradas
```javascript
{
  partnerId: "parceiro_001",
  periodo: "2024-12",
  plano: "PROFISSIONAL",

  uso: {
    pecasGeradas: 342,      // de 500
    tokensInput: 1250000,   // Total
    tokensOutput: 2100000,  // Total
    armazenamento: 28.5,    // GB de 50 GB

    custoAWS: 68.25,        // Real AWS
    custoStorage: 25.00,    // Real Render
    custoInfra: 7.00,       // Real Render
    custoTotal: 100.25,     // Total real

    markup30: 30.08,        // 30% sobre custo
    valorCobrado: 130.33,   // Total a cobrar

    economizado: 8.77       // DiferenÃ§a do plano fixo
  },

  alertas: [
    "Uso em 68% da cota mensal",
    "Economia de $8.77 vs pay-as-you-go"
  ]
}
```

### Dashboard de Faturamento
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PARCEIRO: EscritÃ³rio Silva & Associados   â”‚
â”‚  PLANO: Profissional                        â”‚
â”‚  PERÃODO: Dezembro 2024                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PeÃ§as geradas:    342 / 500 (68%)         â”‚
â”‚  Armazenamento:    28.5 GB / 50 GB (57%)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CUSTOS REAIS:                              â”‚
â”‚  â€¢ AWS Bedrock:        $68.25               â”‚
â”‚  â€¢ Armazenamento:      $25.00               â”‚
â”‚  â€¢ Infraestrutura:     $7.00                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚  SUBTOTAL:             $100.25              â”‚
â”‚                                             â”‚
â”‚  MARKUP (30%):         $30.08               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚  TOTAL A FATURAR:      $130.33              â”‚
â”‚  ou R$ 651,65                               â”‚
â”‚                                             â”‚
â”‚  ğŸ’¡ Economia vs plano fixo: $8.77           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ IMPLEMENTAÃ‡ÃƒO TÃ‰CNICA COMPLETA

### 1. DefiniÃ§Ã£o de Modelos e Custos
```javascript
// lib/ai-models-pricing.js

const AI_MODELS = {
  HAIKU: {
    id: 'claude-3-haiku-20240307',
    name: 'Claude Haiku',
    provider: 'anthropic',
    pricing: {
      input: 0.00025,  // $ por 1K tokens
      output: 0.00125
    },
    maxTokens: 4096,
    useCase: 'ExtraÃ§Ãµes simples, resumos, buscas',
    speed: 'very_fast',
    quality: 'good'
  },

  SONNET_4_5: {
    id: 'anthropic.claude-sonnet-4-5-20250929-v1:0',
    name: 'Claude Sonnet 4.5',
    provider: 'anthropic',
    pricing: {
      input: 0.003,    // $ por 1K tokens
      output: 0.015
    },
    maxTokens: 8192,
    useCase: 'PeÃ§as jurÃ­dicas padrÃ£o, anÃ¡lise complexa',
    speed: 'normal',
    quality: 'excellent'
  },

  OPUS: {
    id: 'claude-3-opus-20240229',
    name: 'Claude Opus',
    provider: 'anthropic',
    pricing: {
      input: 0.015,    // $ por 1K tokens
      output: 0.075
    },
    maxTokens: 8192,
    useCase: 'Casos crÃ­ticos STF/STJ, pareceres tÃ©cnicos',
    speed: 'slow',
    quality: 'superior'
  }
};

module.exports = { AI_MODELS };
```

### 2. Sistema de Roteamento Inteligente
```javascript
// lib/ai-router.js

const { AI_MODELS } = require('./ai-models-pricing');

class AIRouter {

  /**
   * Analisa a tarefa e seleciona o modelo mais adequado
   */
  async selectModel(taskType, context = {}) {
    const {
      complexity,
      documentLength,
      isLegalPiece,
      isCriticalCase,
      userPreference
    } = context;

    // Se usuÃ¡rio especificou modelo, usar esse
    if (userPreference && AI_MODELS[userPreference]) {
      return AI_MODELS[userPreference];
    }

    // Regras de roteamento automÃ¡tico
    switch(taskType) {
      // HAIKU: Tarefas simples
      case 'extraction':
      case 'summary':
      case 'kb_search':
      case 'jurisprudence_analysis':
        return AI_MODELS.HAIKU;

      // OPUS: Casos crÃ­ticos
      case 'stf_petition':
      case 'stj_petition':
      case 'technical_opinion':
      case 'leading_case_analysis':
        return AI_MODELS.OPUS;

      // SONNET 4.5: PeÃ§as padrÃ£o
      case 'initial_petition':
      case 'appeal':
      case 'defense':
      case 'habeas_corpus':
      default:
        // AnÃ¡lise adicional por complexidade
        if (isCriticalCase || (documentLength && documentLength > 50000)) {
          return AI_MODELS.OPUS;
        }
        return AI_MODELS.SONNET_4_5;
    }
  }

  /**
   * Calcula custo estimado antes de processar
   */
  estimateCost(model, estimatedTokens) {
    const { input, output } = estimatedTokens;
    const pricing = model.pricing;

    const inputCost = (input / 1000) * pricing.input;
    const outputCost = (output / 1000) * pricing.output;

    return {
      inputCost,
      outputCost,
      totalCost: inputCost + outputCost,
      model: model.name,
      breakdown: {
        input: `${input} tokens Ã— $${pricing.input}/1K = $${inputCost.toFixed(4)}`,
        output: `${output} tokens Ã— $${pricing.output}/1K = $${outputCost.toFixed(4)}`
      }
    };
  }
}

module.exports = new AIRouter();
```

### 3. Tracking de Uso por Modelo
```javascript
// lib/usage-tracker.js

class UsageTracker {

  /**
   * Registra uso de modelo com todos os detalhes
   */
  async trackUsage({
    partnerId,
    userId,
    projectId,
    taskType,
    model,
    tokensInput,
    tokensOutput,
    responseTime,
    success
  }) {

    const pricing = model.pricing;

    const usage = {
      // IdentificaÃ§Ã£o
      partnerId,
      userId,
      projectId,
      timestamp: new Date().toISOString(),

      // Tarefa
      taskType,

      // Modelo usado
      model: {
        id: model.id,
        name: model.name
      },

      // Tokens
      tokens: {
        input: tokensInput,
        output: tokensOutput,
        total: tokensInput + tokensOutput
      },

      // Custos (AWS)
      costs: {
        input: (tokensInput / 1000) * pricing.input,
        output: (tokensOutput / 1000) * pricing.output,
        total: ((tokensInput / 1000) * pricing.input) +
               ((tokensOutput / 1000) * pricing.output)
      },

      // Performance
      responseTime,
      success
    };

    // Salvar no banco
    await this.saveToDatabase(usage);

    // Atualizar contadores em tempo real
    await this.updateCounters(partnerId, usage);

    return usage;
  }

  /**
   * Obter estatÃ­sticas de uso por modelo do parceiro
   */
  async getPartnerStatsByModel(partnerId, period = 'month') {
    const usages = await this.getUsages(partnerId, period);

    const statsByModel = {
      haiku: {
        tasks: 0,
        tokens: { input: 0, output: 0, total: 0 },
        costs: { input: 0, output: 0, total: 0 }
      },
      sonnet_4_5: {
        tasks: 0,
        tokens: { input: 0, output: 0, total: 0 },
        costs: { input: 0, output: 0, total: 0 }
      },
      opus: {
        tasks: 0,
        tokens: { input: 0, output: 0, total: 0 },
        costs: { input: 0, output: 0, total: 0 }
      }
    };

    // Agregar dados
    usages.forEach(usage => {
      const modelKey = this.getModelKey(usage.model.id);
      const stats = statsByModel[modelKey];

      stats.tasks++;
      stats.tokens.input += usage.tokens.input;
      stats.tokens.output += usage.tokens.output;
      stats.tokens.total += usage.tokens.total;
      stats.costs.input += usage.costs.input;
      stats.costs.output += usage.costs.output;
      stats.costs.total += usage.costs.total;
    });

    return statsByModel;
  }

  getModelKey(modelId) {
    if (modelId.includes('haiku')) return 'haiku';
    if (modelId.includes('opus')) return 'opus';
    return 'sonnet_4_5';
  }
}

module.exports = new UsageTracker();
```

### 4. IntegraÃ§Ã£o no Server
```javascript
// src/server-enhanced.js

const AIRouter = require('../lib/ai-router');
const UsageTracker = require('../lib/usage-tracker');
const { AI_MODELS } = require('../lib/ai-models-pricing');

// API - Processar com seleÃ§Ã£o inteligente de modelo
app.post('/api/chat', async (req, res) => {
  try {
    const { message, taskType, modelPreference } = req.body;
    const partnerId = req.session.partnerId || 'rom';
    const userId = req.session.userId;

    // 1. Selecionar modelo ideal
    const selectedModel = await AIRouter.selectModel(taskType, {
      userPreference: modelPreference,
      // ... outros contextos
    });

    console.log(`ğŸ¤– Modelo selecionado: ${selectedModel.name}`);

    // 2. Estimar custo
    const estimate = AIRouter.estimateCost(selectedModel, {
      input: 5000,  // Estimativa
      output: 8000
    });

    console.log(`ğŸ’° Custo estimado: $${estimate.totalCost.toFixed(4)}`);

    // 3. Processar com Claude
    const startTime = Date.now();
    const response = await processWithClaude(selectedModel, message);
    const responseTime = Date.now() - startTime;

    // 4. Rastrear uso
    await UsageTracker.trackUsage({
      partnerId,
      userId,
      taskType,
      model: selectedModel,
      tokensInput: response.usage.input_tokens,
      tokensOutput: response.usage.output_tokens,
      responseTime,
      success: true
    });

    res.json({
      response: response.content,
      model: selectedModel.name,
      usage: response.usage,
      cost: {
        input: (response.usage.input_tokens / 1000) * selectedModel.pricing.input,
        output: (response.usage.output_tokens / 1000) * selectedModel.pricing.output
      }
    });

  } catch (error) {
    console.error('Erro no chat:', error);
    res.status(500).json({ error: error.message });
  }
});

// API - EstatÃ­sticas por modelo
app.get('/api/usage/by-model', async (req, res) => {
  try {
    const partnerId = req.session.partnerId || 'rom';
    const period = req.query.period || 'month';

    const stats = await UsageTracker.getPartnerStatsByModel(partnerId, period);

    res.json({
      success: true,
      period,
      stats,
      summary: {
        totalCost: Object.values(stats).reduce((sum, s) => sum + s.costs.total, 0),
        totalTasks: Object.values(stats).reduce((sum, s) => sum + s.tasks, 0)
      }
    });
  } catch (error) {
    console.error('Erro ao obter estatÃ­sticas:', error);
    res.status(500).json({ error: error.message });
  }
});
```

### 2. CÃ¡lculo de Fatura Mensal
```javascript
async function calculateMonthlyBill(partnerId, month) {
  const usage = await getMonthlyUsage(partnerId, month);
  const plan = await getPartnerPlan(partnerId);

  // Custos reais
  const awsCost = usage.totalTokensCost;
  const storageCost = getStorageCost(usage.storageGB);
  const infraCost = 7.00;

  const realCost = awsCost + storageCost + infraCost;
  const markup = realCost * 0.30; // 30%
  const total = realCost + markup;

  return {
    partnerId,
    month,
    plan: plan.name,

    costs: {
      aws: awsCost,
      storage: storageCost,
      infrastructure: infraCost,
      subtotal: realCost
    },

    markup: {
      percentage: 30,
      value: markup
    },

    total: {
      usd: total,
      brl: total * 5.00 // Taxa de cÃ¢mbio
    },

    comparison: {
      fixedPlanCost: plan.fixedPrice,
      actualCost: total,
      savings: plan.fixedPrice - total
    }
  };
}
```

### 3. Alertas de Limite
```javascript
function checkUsageLimits(partnerId, currentUsage, plan) {
  const alerts = [];

  // Alerta de 80% do limite
  if (currentUsage.pieces >= plan.maxPieces * 0.8) {
    alerts.push({
      type: 'warning',
      message: `VocÃª usou ${currentUsage.pieces} de ${plan.maxPieces} peÃ§as (${(currentUsage.pieces/plan.maxPieces*100).toFixed(0)}%)`
    });
  }

  // Alerta de 100% (bloqueio)
  if (currentUsage.pieces >= plan.maxPieces) {
    alerts.push({
      type: 'danger',
      message: 'Limite de peÃ§as atingido! FaÃ§a upgrade do plano.'
    });
  }

  return alerts;
}
```

---

## ğŸ“Š EXEMPLO DE FATURAMENTO REAL

### Caso: EscritÃ³rio MÃ©dio - MÃªs de Novembro

```
Plano contratado: PROFISSIONAL ($139.10/mÃªs fixo)

Uso real no mÃªs:
â”œâ”€â”€ 347 peÃ§as geradas (de 500)
â”œâ”€â”€ Tokens input:  1.245.000
â”œâ”€â”€ Tokens output: 2.100.000
â”œâ”€â”€ Armazenamento: 32 GB (de 50 GB)

CÃ¡lculo do custo real:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. AWS Bedrock:
   Input:  1.245 Ã— $0.003 = $3.74
   Output: 2.100 Ã— $0.015 = $31.50
   Subtotal AWS: $35.24

2. Armazenamento (50 GB): $25.00
3. Infraestrutura: $7.00
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   CUSTO REAL: $67.24
   + Markup 30%: $20.17
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   TOTAL VARIÃVEL: $87.41

ComparaÃ§Ã£o com plano fixo:
   Plano fixo: $139.10
   Custo real + markup: $87.41
   ECONOMIA: $51.69 (37%)

ğŸ’¡ Neste mÃªs, o parceiro economizou 37% em relaÃ§Ã£o ao plano fixo!
```

---

## ğŸ¯ VANTAGENS DO MODELO

### Para o Parceiro (EscritÃ³rio)
âœ… Paga apenas pelo que usa (se gastar menos)
âœ… TransparÃªncia total nos custos
âœ… Pode escolher entre fixo ou variÃ¡vel
âœ… NÃ£o paga por tokens no upload (100% grÃ¡tis)

### Para ROM Agent
âœ… Margem garantida de 30% sobre custos
âœ… EscalÃ¡vel sem risco
âœ… Custos repassados automaticamente
âœ… FÃ¡cil ajuste de preÃ§os (apenas markup)

---

## ğŸ”® PROJEÃ‡Ã•ES DE FATURAMENTO

### CenÃ¡rio: 50 Parceiros Ativos

| Plano | Parceiros | Receita Mensal | Receita Anual |
|-------|-----------|----------------|---------------|
| Essencial (R$ 189) | 20 | R$ 3.780 | R$ 45.360 |
| Profissional (R$ 696) | 25 | R$ 17.400 | R$ 208.800 |
| Empresarial (R$ 2.678) | 5 | R$ 13.390 | R$ 160.680 |
| **TOTAL** | **50** | **R$ 34.570** | **R$ 414.840** |

**Com 100 parceiros**: R$ 69.140/mÃªs ou R$ 829.680/ano

---

## ğŸ“‹ CHECKLIST DE IMPLEMENTAÃ‡ÃƒO

- [ ] Criar tabela de planos no banco
- [ ] Implementar tracking de tokens por parceiro
- [ ] Dashboard de uso para parceiro
- [ ] Sistema de alertas de limite
- [ ] CÃ¡lculo automÃ¡tico de fatura mensal
- [ ] IntegraÃ§Ã£o com gateway de pagamento
- [ ] RelatÃ³rio de custos vs receita
- [ ] Sistema de upgrade/downgrade de plano

---

**ğŸ¯ RESUMO EXECUTIVO COMPLETO:**

## âœ… VANTAGENS DO SISTEMA

### Para o Parceiro:
âœ… **TransparÃªncia Total**: VÃª exatamente quanto custa cada modelo
âœ… **Economia AutomÃ¡tica**: Sistema escolhe modelo mais barato quando possÃ­vel
âœ… **Qualidade Garantida**: Modelo premium (Opus) usado apenas quando necessÃ¡rio
âœ… **Flexibilidade**: Pode forÃ§ar modelo especÃ­fico se quiser
âœ… **RelatÃ³rios Detalhados**: Sabe exatamente onde gastou

### Para ROM Agent:
âœ… **Margem Garantida**: 30% sobre TODOS os custos (IA + Storage + Infra + APIs)
âœ… **EscalÃ¡vel**: Custos variam proporcionalmente com uso
âœ… **PrevisÃ­vel**: Modelo baseado em custos reais
âœ… **Competitivo**: Roteamento inteligente reduz custos vs concorrentes

### Diferenciais:
âœ… **Modelo transparente**: Custos reais + 30% markup
âœ… **3 Modelos DisponÃ­veis**: Haiku, Sonnet 4.5, Opus
âœ… **Roteamento AutomÃ¡tico**: IA escolhe melhor modelo
âœ… **Economia atÃ© 98%**: Haiku vs Opus em tarefas simples
âœ… **Tracking Completo**: Por modelo, por tarefa, por projeto
âœ… **Upload 4x Maior**: 100MB vs 25MB do Claude
âœ… **Zero Tokens Upload**: Processamento assÃ­ncrono

---

## ğŸ“Š COMPARAÃ‡ÃƒO FINAL: ROM vs CONCORRENTES

| Recurso | ROM Agent | Claude.ai | GPT-4 |
|---------|-----------|-----------|-------|
| **Modelos DisponÃ­veis** | 3 (Haiku/Sonnet/Opus) | 1 (Sonnet) | 1 (GPT-4) |
| **Roteamento AutomÃ¡tico** | âœ… SIM | âŒ NÃƒO | âŒ NÃƒO |
| **Upload sem Tokens** | âœ… SIM (0 tokens) | âŒ NÃƒO | âŒ NÃƒO |
| **Tamanho Upload** | 100MB | 25MB | 25MB |
| **TransparÃªncia Custos** | âœ… Total | âš ï¸ Parcial | âš ï¸ Parcial |
| **Economia Potencial** | AtÃ© 98% | 0% | 0% |
| **Tracking por Modelo** | âœ… SIM | âŒ NÃƒO | âŒ NÃƒO |
| **JurisprudÃªncia Auto** | âœ… SIM | âŒ NÃƒO | âŒ NÃƒO |
| **KB por Projeto** | âœ… SIM | âŒ NÃƒO | âŒ NÃƒO |

---

## ğŸš€ PRÃ“XIMOS PASSOS

### ImplementaÃ§Ã£o Imediata:
1. âœ… Criar mÃ³dulo `lib/ai-models-pricing.js`
2. âœ… Criar classe `AIRouter` em `lib/ai-router.js`
3. âœ… Criar `UsageTracker` em `lib/usage-tracker.js`
4. âœ… Integrar no `server-enhanced.js`
5. âœ… Criar API `/api/usage/by-model`
6. âœ… Atualizar dashboard para mostrar uso por modelo

### Melhorias Futuras:
- Machine Learning para otimizar seleÃ§Ã£o de modelo
- Cache inteligente por tipo de tarefa
- PrediÃ§Ã£o de custos mensais
- Alertas automÃ¡ticos de economia
- A/B testing entre modelos

---

**ğŸ“… Ãšltima AtualizaÃ§Ã£o**: 13 de dezembro de 2024
**ğŸ‘¤ ResponsÃ¡vel**: Equipe ROM Agent
**ğŸ“§ Contato**: dev@rom-agent.com

---

**ğŸ’¡ NOTAS IMPORTANTES:**

### Sobre o Sistema de TarifaÃ§Ã£o:

Este sistema cobre **TODO O SISTEMA**, nÃ£o apenas ferramentas de extraÃ§Ã£o:
- âœ… Todos os modelos de IA (Haiku, Sonnet 4.5, Opus)
- âœ… Custos de hospedagem (Render.com)
- âœ… Armazenamento (Storage)
- âœ… APIs externas (DataJud CNJ)
- âœ… Infraestrutura completa
- âœ… Markup de 30% + IOF 6,38% aplicados

### Taxa de CÃ¢mbio DinÃ¢mica:

```
âš ï¸ IMPORTANTE: Taxa de cÃ¢mbio Ã© atualizada na DATA DO PAGAMENTO

Exemplo:
- Plano contratado: R$ 177,00/mÃªs (calculado com dÃ³lar a R$ 5,00)
- Pagamento em 15/01/2025: DÃ³lar estÃ¡ a R$ 5,20
- Valor cobrado: $35,40 Ã— R$ 5,20 = R$ 184,08

Sistema consulta automaticamente:
â€¢ API do Banco Central do Brasil
â€¢ CotaÃ§Ã£o PTAX do dia Ãºtil anterior
â€¢ AtualizaÃ§Ã£o em tempo real antes da cobranÃ§a
```

### Sistema PrÃ©-Pago (Modelo Claude):

```
âœ… PREFERENCIALMENTE PRÃ‰-PAGO

Funcionamento:
1. Parceiro compra crÃ©ditos antecipadamente
   Exemplo: Compra $100,00 em crÃ©ditos

2. CrÃ©ditos sÃ£o consumidos conforme uso
   â€¢ Cada peÃ§a Haiku: $0.013
   â€¢ Cada peÃ§a Sonnet: $0.207
   â€¢ Cada peÃ§a Opus: $1.377

3. Alerta quando crÃ©ditos estÃ£o baixos
   âš ï¸ Aviso em 80%: "VocÃª tem $20 restantes"
   âš ï¸ Aviso em 90%: "VocÃª tem $10 restantes"

4. Sistema BLOQUEIA ao atingir limite
   âŒ CrÃ©ditos zerados: "Recarregue para continuar"
   (Igual ao Claude.ai)

5. Recarga automÃ¡tica (opcional)
   âœ“ Auto-recarga de $100 quando < $10
   âœ“ CartÃ£o cadastrado cobra automaticamente
```

### Planos PrÃ©-Pagos:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PACOTE STARTER                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CrÃ©ditos: $50,00                                 â”‚
â”‚ Rende aproximadamente:                           â”‚
â”‚   â€¢ 240 peÃ§as Haiku (tarefas simples)           â”‚
â”‚   â€¢ 240 peÃ§as Sonnet (peÃ§as padrÃ£o)             â”‚
â”‚   â€¢ 36 peÃ§as Opus (casos crÃ­ticos)              â”‚
â”‚ Validade: 90 dias                                â”‚
â”‚ PreÃ§o: R$ 260,00* (com IOF + cÃ¢mbio R$ 5,00)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PACOTE PROFESSIONAL                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CrÃ©ditos: $150,00                                â”‚
â”‚ Rende aproximadamente:                           â”‚
â”‚   â€¢ 725 peÃ§as Sonnet (peÃ§as padrÃ£o)             â”‚
â”‚ Validade: 180 dias                               â”‚
â”‚ PreÃ§o: R$ 780,00* (com IOF + cÃ¢mbio R$ 5,00)    â”‚
â”‚ BÃ”NUS: +10% crÃ©ditos grÃ¡tis ($15)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PACOTE ENTERPRISE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CrÃ©ditos: $500,00                                â”‚
â”‚ Rende aproximadamente:                           â”‚
â”‚   â€¢ 2.415 peÃ§as Sonnet (peÃ§as padrÃ£o)           â”‚
â”‚ Validade: 365 dias                               â”‚
â”‚ PreÃ§o: R$ 2.600,00* (com IOF + cÃ¢mbio R$ 5,00)  â”‚
â”‚ BÃ”NUS: +20% crÃ©ditos grÃ¡tis ($100)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

*Taxa de cÃ¢mbio atualizada na data do pagamento
```

### Dashboard de CrÃ©ditos:

```javascript
// Exemplo de dashboard do parceiro

{
  "creditos": {
    "saldo": "$45.30",
    "valorReais": "R$ 226,50", // CÃ¢mbio atual
    "ultimaRecarga": "2024-12-01",
    "proximoVencimento": "2025-03-01"
  },

  "uso": {
    "totalGasto": "$54.70",
    "pecasGeradas": 342,
    "breakdown": {
      "haiku": {
        "pecas": 150,
        "custo": "$1.95"
      },
      "sonnet": {
        "pecas": 180,
        "custo": "$37.26"
      },
      "opus": {
        "pecas": 12,
        "custo": "$16.52"
      }
    }
  },

  "alertas": [
    {
      "tipo": "warning",
      "mensagem": "CrÃ©ditos abaixo de 50%. Considere recarregar.",
      "acao": "Recarregar Agora"
    }
  ]
}
```

---

**Resultado**: PreÃ§o justo, transparente, escalÃ¡vel e com controle total de gastos para parceiros.
